appId: chat.rocket.reactnative
name: Accessibility and Appearance
onFlowStart:
  - runFlow: '../../helpers/setup.yaml'
onFlowComplete:
  - evalScript: ${output.utils.deleteCreatedUsers()}
tags:
  - test-5
  - android-only

---
- evalScript: ${output.user = output.utils.createUser()}
- runFlow:
    file: '../../helpers/login-with-deeplink.yaml'
    env:
      USERNAME: ${output.user.username}
      PASSWORD: ${output.user.password}
- runFlow:
    file: './utils/go-to-accessibility-appearance.yaml'

# should have accessibility view list
- extendedWaitUntil:
    visible:
      id: 'accessibility-view-list'
    timeout: 

# should have menu button
- extendedWaitUntil:
    visible:
      id: 'accessibility-view-drawer'
    timeout: 

# should have theme button
- extendedWaitUntil:
    visible:
      id: 'accessibility-theme-button'
    timeout: 

# should have display button
- extendedWaitUntil:
    visible:
      id: 'accessibility-display-button'
    timeout: 

# should have rooms with hashtag symbol switch
- extendedWaitUntil:
    visible:
      id: 'accessibility-rooms-with-hashtag-symbol-switch'
    timeout: 

# should have mentions with at symbol switch
- extendedWaitUntil:
    visible:
      id: 'accessibility-mentions-with-at-symbol-switch'
    timeout: 

# should have autoplay gifs switch
- extendedWaitUntil:
    visible:
      id: 'accessibility-autoplay-gifs-switch'
    timeout: 

# should enable mentions with @ symbol
- extendedWaitUntil:
    visible:
      id: 'accessibility-mentions-with-at-symbol-switch'
    timeout: 
- tapOn:
    id: 'accessibility-mentions-with-at-symbol-switch'

- extendedWaitUntil:
    visible:
      id: 'accessibility-view-drawer'
    timeout: 
- tapOn:
    id: 'accessibility-view-drawer'
- extendedWaitUntil:
    visible:
      id: 'sidebar-chats'
    timeout: 
- tapOn:
    id: 'sidebar-chats'
- runFlow:
    file: '../../helpers/search-and-navigate-room.yaml'
    env:
      ROOM: 'maestro-accessibility-test'

- extendedWaitUntil:
    visible:
      text: '@all - all mention'
    timeout: 
- extendedWaitUntil:
    visible:
      text: '@rocket.cat - user mention'
    timeout: 

# should disable mentions with @ symbol
- tapOn:
    id: header-back
- runFlow:
    file: './utils/go-to-accessibility-appearance.yaml'

- extendedWaitUntil:
    visible:
      id: 'accessibility-mentions-with-at-symbol-switch'
    timeout: 
- tapOn:
    id: 'accessibility-mentions-with-at-symbol-switch'

- extendedWaitUntil:
    visible:
      id: 'accessibility-view-drawer'
    timeout: 
- tapOn:
    id: 'accessibility-view-drawer'
- extendedWaitUntil:
    visible:
      id: 'sidebar-chats'
    timeout: 
- tapOn:
    id: 'sidebar-chats'
- runFlow:
    file: '../../helpers/search-and-navigate-room.yaml'
    env:
      ROOM: 'maestro-accessibility-test'

- extendedWaitUntil:
    visible:
      text: 'all - all mention'
    timeout: 
- extendedWaitUntil:
    visible:
      text: 'rocket.cat - user mention'
    timeout: 

# should enable rooms with # symbol
- tapOn:
    id: header-back
- runFlow:
    file: './utils/go-to-accessibility-appearance.yaml'

- extendedWaitUntil:
    visible:
      id: 'accessibility-rooms-with-hashtag-symbol-switch'
    timeout: 
- tapOn:
    id: 'accessibility-rooms-with-hashtag-symbol-switch'

- extendedWaitUntil:
    visible:
      id: 'accessibility-view-drawer'
    timeout: 
- tapOn:
    id: 'accessibility-view-drawer'
- extendedWaitUntil:
    visible:
      id: 'sidebar-chats'
    timeout: 
- tapOn:
    id: 'sidebar-chats'
- runFlow:
    file: '../../helpers/search-and-navigate-room.yaml'
    env:
      ROOM: 'maestro-accessibility-test'

- extendedWaitUntil:
    visible:
      text: '#general - channel mention'
    timeout: 

# should disable mentions with # symbol
- tapOn:
    id: header-back
- runFlow:
    file: './utils/go-to-accessibility-appearance.yaml'

- extendedWaitUntil:
    visible:
      id: 'accessibility-rooms-with-hashtag-symbol-switch'
    timeout: 
- tapOn:
    id: 'accessibility-rooms-with-hashtag-symbol-switch'

- extendedWaitUntil:
    visible:
      id: 'accessibility-view-drawer'
    timeout: 
- tapOn:
    id: 'accessibility-view-drawer'
- extendedWaitUntil:
    visible:
      id: 'sidebar-chats'
    timeout: 
- tapOn:
    id: 'sidebar-chats'
- runFlow:
    file: '../../helpers/search-and-navigate-room.yaml'
    env:
      ROOM: 'maestro-accessibility-test'
- extendedWaitUntil:
    visible:
      text: 'general - channel mention'
    timeout: 
